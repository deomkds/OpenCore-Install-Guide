(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{486:function(e,a,t){e.exports=t.p+"assets/img/mmio-white.0ee7b5c7.png"},654:function(e,a,t){"use strict";t.r(a);var o=t(28),s=Object(o.a)({},(function(){var e=this,a=e.$createElement,o=e._self._c||a;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"calculando-o-valor-de-slide-do-kaslr"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#calculando-o-valor-de-slide-do-kaslr"}},[e._v("#")]),e._v(" Calculando o Valor de Slide do KASLR")]),e._v(" "),o("p",[e._v('Essa seção é para aqueles usuários que queiram entender e corrigir o erro "Couldn\'t allocate runtime area", mais comum em placas-mãe Z390, X99 e X299.')]),e._v(" "),o("ul",[o("li",[e._v("Observação: é necessário usar o OpenCore. O Clover não é mais suportado.")])]),e._v(" "),o("h2",{attrs:{id:"definicao-de-kaslr"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#definicao-de-kaslr"}},[e._v("#")]),e._v(" Definição de KASLR")]),e._v(" "),o("p",[e._v("KASLR significa, em inglês, "),o("em",[e._v("Kernel Address Space Layout Randomization")]),e._v(" (Aleatorização do Leiaute do Espaço de Endereços do Kernel). É usado para fins de segurança. Mais precisamente, o KASLR dificulta que invasores descubram onde os objetos importantes estão na memória, já que as posições são aleatórias entre computadores e inicializações. Uma explicação mais aprofundada sobre o KASLR pode ser encontrada "),o("a",{attrs:{href:"https://lwn.net/Articles/569635/",target:"_blank",rel:"noopener noreferrer"}},[e._v("aqui"),o("OutboundLink")],1),e._v(" (em inglês).")]),e._v(" "),o("p",[e._v("Isso se torna um problema quando aparecem computadores com mapas de memória pequenos ou que possuem muitos dispositivos presentes. Embora seja bastante provável haver espaço para o "),o("em",[e._v("kernel")]),e._v(" operar, existem muitas outras áreas livres onde o "),o("em",[e._v("kernel")]),e._v(" não cabe completamente. É nesse cenário que entra o "),o("code",[e._v("slide=xxx")]),e._v(". Em vez de deixar que o macOS escolha uma área aleatória para operar a cada inicialização, ele é forçado a operar em um local em que se sabe que irá funcionar.")]),e._v(" "),o("h2",{attrs:{id:"para-quem-se-aplica"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#para-quem-se-aplica"}},[e._v("#")]),e._v(" Para Quem Se Aplica")]),e._v(" "),o("p",[e._v("Como mencionado anteriormente, essa opções são para usuários que não possuem espaço suficiente para o "),o("em",[e._v("kernel")]),e._v(" ou em situações em que ele se move para lugares muito pequenos. Geralmente resultará em um erro como esse ao iniciar:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("Error allocating 0x1197b pages at 0x0000000017a80000 alloc type 2\nCouldn't allocate runtime area\n")])])]),o("p",[e._v("Com algumas variações:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("Only 244/256 slide values are usable!\n")])])]),o("p",[e._v("Ou até mesmo travamentos ao executar o macOS:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("panic(cpu 6 caller 0xffffff801fc057ba): a freed zone element has been modified in zone kalloc.4096: expected 0x3f00116dbe8a46f6 but found 0x3f00116d00000000\n")])])]),o("p",[e._v("A melhor parte sobre esses erros é que eles podem ser aleatórios. Isso também explica por que ligar e desligar o computador 20 vezes pode resolver o problema, embora temporariamente.")]),e._v(" "),o("p",[e._v("Fato curioso: leva mais ou menos 31ms para o "),o("em",[e._v("kernel")]),e._v(" encontrar uma área de operação. Configurar um valor de "),o("code",[e._v("slide")]),e._v(" manulmente pode, em média, reduzir o tempo de inicialização por incríveis 0,207%!!!")]),e._v(" "),o("h2",{attrs:{id:"como-corrigir"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#como-corrigir"}},[e._v("#")]),e._v(" Como Corrigir")]),e._v(" "),o("p",[e._v("A solução real para isso é bastante simples, na verdade. Será necessário:")]),e._v(" "),o("ul",[o("li",[o("strong",[e._v("Usuários do OpenCore")]),e._v(":\n"),o("ul",[o("li",[o("a",{attrs:{href:"https://github.com/acidanthera/OpenCorePkg/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenRuntime"),o("OutboundLink")],1)]),e._v(" "),o("li",[o("a",{attrs:{href:"https://github.com/acidanthera/OpenCorePkg/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenShell"),o("OutboundLink")],1),e._v(" (Não se esqueça de ativá-lo no caminho "),o("code",[e._v("Root -> Misc -> Tools")]),e._v(").")])])])]),e._v(" "),o("p",[e._v("E também será preciso alterar a "),o("code",[e._v("config.plist")]),e._v(", na seção "),o("code",[e._v("Booter")]),e._v(":")]),e._v(" "),o("ul",[o("li",[o("strong",[e._v("AvoidRuntimeDefrag")]),e._v(": YES\n"),o("ul",[o("li",[e._v("Corrige serviços UEFI em tempo de execução, como a data, a hora, a NVRAM, o controle de energia etc.")])])]),e._v(" "),o("li",[o("strong",[e._v("DevirtualiseMmio")]),e._v(": YES\n"),o("ul",[o("li",[e._v("Reduz a quantidade de memória reservada, expande as opções de valores do "),o("code",[e._v("slide=N")]),e._v(" e ajuda bastante a corrigir problemas de alocação de memória em placas-mãe Z390.")])])]),e._v(" "),o("li",[o("strong",[e._v("EnableSafeModeSlide")]),e._v(": YES\n"),o("ul",[o("li",[e._v("Permite que as variáveis "),o("code",[e._v("slide")]),e._v(" possam ser usadas no modo de segurança.")])])]),e._v(" "),o("li",[o("strong",[e._v("ProtectUefiServices")]),e._v(": NO\n"),o("ul",[o("li",[e._v("Protege os serviços de UEFI para que eles não sejam sobrescritos pelo firmware. Relevante principalmente em máquinas virtuais, computadores série 300 e mais novos baseados em Ice Lake e Comet Lake.")])])]),e._v(" "),o("li",[o("strong",[e._v("ProvideCustomSlide")]),e._v(": YES\n"),o("ul",[o("li",[e._v("Isso garante que o "),o("em",[e._v("kernel")]),e._v(" somente escolherá regiões boas e evitará aquelas que podem resultar em falhas de inicialização. Ainda é aleatório, mas omite as regiões ruins na aleatorização.")])])]),e._v(" "),o("li",[o("strong",[e._v("RebuildAppleMemoryMap")]),e._v(": YES\n"),o("ul",[o("li",[e._v("Gera um mapa de memória compatível com o macOS, mas pode não funcionar em alguns firmwares de notebooks OEM. Se encontrar falhas precoces na inicialização, desative esta opção. Isso garante que o mapa de memória se encaixará naquilo que o kernel espera.")])])])]),e._v(" "),o("h2",{attrs:{id:"preparando-a-bios"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#preparando-a-bios"}},[e._v("#")]),e._v(" Preparando a BIOS")]),e._v(" "),o("p",[e._v("O motivo pelo qual é preciso redefinir o mapa de memória é porque ele precisa ser mais determinístico. A ideia é que haja menos variação entre inicializações para que aconteçam menos casos nos quais o kernel não encontra espaço suficiente para operar (mapas de memória não são sempre consistentes nas inicializações). Para isso:")]),e._v(" "),o("ul",[o("li",[e._v("Atualize a BIOS (extremamente importante, pois BIOS mais antigas são conhecidas por terem problemas de mapa de memória, especialmente na Z390).")]),e._v(" "),o("li",[e._v("Limpe o CMOS.")]),e._v(" "),o("li",[e._v("Ative configurações necessárias na BIOS:\n"),o("ul",[o("li",[o("code",[e._v("Above4GDecoding")]),e._v(": Isso permite que dispositivos utilizem as regiões de memória acima dos 4GB. Significa que o macOS terá mais espaço onde se enfiar, mas pode ser problemático em algumas placas-mãe X99 e X299, então é recomendado testar com essa opção ligada e desligada.\n"),o("ul",[o("li",[e._v("Observação: em BIOS que suportam "),o("code",[e._v("Resizable BAR Support")]),e._v(", ativar o "),o("code",[e._v("Above4GDecoding")]),e._v(" habilitará a opção. Tenha certeza de que o suporte a BAR esteja desativado se a opção aparecer.")])])]),e._v(" "),o("li",[o("code",[e._v("Boot Options -> Windows8.1/10 mode")]),e._v(": Isso garantirá que nenhum lixo legado antigo seja carregado. Fato curioso: "),o("code",[e._v("Other OS")]),e._v(" foi feito para iniciar versões antigas do Windows e não outros sistemas operacionais.")])])]),e._v(" "),o("li",[e._v("Desative o máximo de dispositivos desnecessários na BIOS (isso significa que haverá menos variação no mapa de memória a cada inicialização, o que diminui as chances de ocorrerem falhas na inicialização). Configurações comuns:\n"),o("ul",[o("li",[o("code",[e._v("CSM")]),e._v(": para suporte a SOs antigos; adiciona um monte de lixo desnecessário. Também pode fazer o "),o("em",[e._v("shell")]),e._v(" parar de funcionar, impedindo a sua inicialização.")]),e._v(" "),o("li",[o("code",[e._v("Intel SGX")]),e._v(": Software Guard Extensions. Ocupa muito espaço na memória e não faz nada no macOS.")]),e._v(" "),o("li",[o("code",[e._v("Parallel Port")]),e._v(": o macOS nem consegue enxergar as portas paralelas.")]),e._v(" "),o("li",[o("code",[e._v("Serial Port")]),e._v(": eu gostaria de saber quantos de vocês estão depurando um "),o("em",[e._v("kernel")]),e._v("...")]),e._v(" "),o("li",[o("code",[e._v("iGPU")]),e._v(": não é ideal, mas alguns computadores possuem mapas tão lotados que a GPU integrada simplesmente não cabe.")]),e._v(" "),o("li",[o("code",[e._v("Thunderbolt")]),e._v(": muitos "),o("em",[e._v("hackintoshes")]),e._v(" nem possuem portas Thunderbolt funcionais, e as placas que não têm portas Thunderbolt mas possuem essa opção só desperdiçam ainda mais espaço.")]),e._v(" "),o("li",[o("code",[e._v("LED lighting")]),e._v(": desculpa, cara, mas é hora de cair fora.")]),e._v(" "),o("li",[o("code",[e._v("Legacy USB")]),e._v(": mais porcaria antiga.")])])])]),e._v(" "),o("h2",{attrs:{id:"inicializacao-de-teste"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#inicializacao-de-teste"}},[e._v("#")]),e._v(" Inicialização de Teste")]),e._v(" "),o("p",[e._v("Com a EFI ajustada, a "),o("code",[e._v("config.plist")]),e._v(" e a BIOS configuradas, é hora de testar a nova configuração. Se ainda tiver problemas, será necessário mergulhar mais fundo e calcular o valor de "),o("code",[e._v("slide")]),e._v(".")]),e._v(" "),o("h2",{attrs:{id:"encontrando-o-valor-de-slide"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#encontrando-o-valor-de-slide"}},[e._v("#")]),e._v(" Encontrando o Valor de Slide")]),e._v(" "),o("p",[e._v("Abra o "),o("code",[e._v("shell")]),e._v(" EFI no seu gerenciador de "),o("em",[e._v("boot")]),e._v(" preferido e execute o "),o("code",[e._v("memmap")]),e._v(". Isso exibirá uma lista de todas as páginas e seus tamanhos. Aqui é onde a diversão começa.")]),e._v(" "),o("p",[e._v("Exemplo do que será exibido:")]),e._v(" "),o("table",[o("thead",[o("tr",[o("th",{staticStyle:{"text-align":"left"}},[e._v("Tipo")]),e._v(" "),o("th",{staticStyle:{"text-align":"left"}},[e._v("Início")]),e._v(" "),o("th",{staticStyle:{"text-align":"left"}},[e._v("Fim")]),e._v(" "),o("th",{staticStyle:{"text-align":"left"}},[e._v("Nº de Páginas")]),e._v(" "),o("th",{staticStyle:{"text-align":"left"}},[e._v("Atributos")])])]),e._v(" "),o("tbody",[o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("RT_Data")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000001")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("800000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Disponível")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000001000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000057FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000057")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Reservado")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000058000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000058FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000001")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Disponível")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000059000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000008FFFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000037")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("RT_Code")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000090000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000090FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000001")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("800000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Disponível")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000091000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000009DFFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000D")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Reservado")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000009E000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000009FFFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000002")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Disponível")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000100000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000005B635FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000005B536")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("BS_Data")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000005B636000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000005B675FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000040")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Disponível")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000005B676000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006AF77FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000F902")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("LoaderCode")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006AF78000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B155FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("00000000000001DE")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("BS_Data")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B156000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B523FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("00000000000003CE")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("ACPI_NVS")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B524000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B524FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000001")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("BS_Data")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B526000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B625FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("0000000000000100")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Disponível")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B626000")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000006B634FFF")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("000000000000000F")])])])]),e._v(" "),o("p",[e._v("Agora a pergunta que fica é: como diabos isso é convertido para um valor de "),o("code",[e._v("slide")]),e._v(". Bem, é bastante simples. O ponto de interesse é o maior valor disponível dentro da coluna "),o("code",[e._v("Início")]),e._v(". Nesse exemplo, o "),o("code",[e._v("000000006B626000")]),e._v(" é o maior valor. Observe que esses valores estão em hexadecimal, então se houver múltiplos valores próximos uns aos outros, talvez seja necessário convertê-los para decimal. Para calcular o valor de "),o("code",[e._v("slide")]),e._v(", utilize a calculadora integrada do macOS, que possui uma função de programação acessível ao pressionar ⌘+3:")]),e._v(" "),o("p",[o("code",[e._v("000000006B626000")]),e._v(" = "),o("code",[e._v("0x6B626000")])]),e._v(" "),o("p",[e._v("("),o("code",[e._v("0x6B626000")]),e._v(" - "),o("code",[e._v("0x100000")]),e._v(")/"),o("code",[e._v("0x200000")]),e._v(" = "),o("code",[e._v("0x35A")])]),e._v(" "),o("p",[e._v("E para verificar se o valor está correto:")]),e._v(" "),o("p",[o("code",[e._v("0x100000")]),e._v(" + ("),o("code",[e._v("0x35A")]),e._v(" * "),o("code",[e._v("0x200000")]),e._v(") = "),o("code",[e._v("0x6B500000")])]),e._v(" "),o("p",[e._v("Sempre que o valor retornado "),o("strong",[e._v("não")]),e._v(" for o original ("),o("code",[e._v("0x6B500000")]),e._v(" vs "),o("code",[e._v("0x6B626000")]),e._v("), simplesmente adicione 1 ao valor de "),o("code",[e._v("slide")]),e._v(" final. Isso acontece por causa de arredondamento. Por exemplo, o valor "),o("code",[e._v("0x35A")]),e._v(" convertido para decimal se torna "),o("code",[e._v("858")]),e._v(", que, somado a 1, resultará em "),o("code",[e._v("slide=859")]),e._v(".")]),e._v(" "),o("blockquote",[o("p",[e._v("Mas espere só um segundo! Deu um valor maior do que 256!")])]),e._v(" "),o("p",[e._v("Correto. Isso é causado por mapas de memória que incluem setores "),o("code",[e._v("Above4GDecoding")]),e._v(", os quais não podem ser utilizados. Então será necessário continuar descendo na lista até encontrar um valor que seja pequeno o suficiente (neste caso seria "),o("code",[e._v("0000000000100000")]),e._v(").")]),e._v(" "),o("p",[e._v("E só para deixar a fórmula um pouco mais clara:")]),e._v(" "),o("p",[e._v("(HEX - "),o("code",[e._v("0x100000")]),e._v(")/"),o("code",[e._v("0x200000")]),e._v(" = Valor de "),o("code",[e._v("slide")]),e._v(" em hexadecimal.")]),e._v(" "),o("p",[o("code",[e._v("0x100000")]),e._v(" + (valor de "),o("code",[e._v("slide")]),e._v(" em hexadecimal * "),o("code",[e._v("0x200000")]),e._v(") = valor hexadecimal original (se não for, some 1 ao valor de "),o("code",[e._v("slide")]),e._v(").")]),e._v(" "),o("p",[e._v("Agora acesse a "),o("code",[e._v("config.plist")]),e._v(" e adicione o valor de "),o("code",[e._v("slide")]),e._v(" junto com o restante dos argumentos de inicialização (neste caso seria "),o("code",[e._v("slide=0")]),e._v(" ao usar "),o("code",[e._v("0x100000")]),e._v("). Se este valor ainda resultar em erros, então avance para o segundo maior valor da coluna "),o("code",[e._v("Início")]),e._v(" e assim por diante.")]),e._v(" "),o("p",[e._v("Ao calcular o valor de "),o("code",[e._v("slide")]),e._v(", às vezes o valor retornado pode ser muito pequeno, como "),o("code",[e._v("slide=-0.379150390625")]),e._v(". Nesses casos, arredonde para "),o("code",[e._v("slide=0")]),e._v(".")]),e._v(" "),o("p",[e._v("E para os usuários que estejam tendo problemas para encontrar os valores de "),o("code",[e._v("slide")]),e._v(", também podem digitar "),o("code",[e._v("$slide [insira o maior valor da coluna Nº de Páginas]")]),e._v(" no canal #Sandbox no Discor do "),o("a",{attrs:{href:"https://discord.gg/u8V7N5C",target:"_blank",rel:"noopener noreferrer"}},[e._v("r/Hackintosh"),o("OutboundLink")],1),e._v(" (em inglês).")]),e._v(" "),o("blockquote",[o("p",[e._v("Mas isso é tããããããããão difícil")])]),e._v(" "),o("p",[e._v("Bom, não esquenta, pois há uma solução simples. Após abrir o "),o("code",[e._v("memmap")]),e._v(" no "),o("code",[e._v("shell")]),e._v(", execute:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("shell> fs0: //Substitua pelo seu pendrive.\n\nfs0:\\> dir //Para verificar que se trada do diretório correto. Se não, tente fs1 e assim por diante.\n\nDirectory of fs0:\\\n01/01/01 3:30p   EFI\n\nfs0:\\> memmap > memmap.txt\n")])])]),o("p",[e._v("Isso criará um arquivo "),o("code",[e._v("memmap.txt")]),e._v(" na raíz da sua partição EFI. Agora, poste o arquivo no Discord do r/Hackintosh, no canal #Sandbox e digite "),o("code",[e._v("$slide [insira um link para o arquivo memmap.txt]")]),e._v(".")]),e._v(" "),o("h2",{attrs:{id:"usando-o-devirtualisemmio"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#usando-o-devirtualisemmio"}},[e._v("#")]),e._v(" Usando o DevirtualiseMmio")]),e._v(" "),o("p",[e._v("O DevirtualiseMmio é uma "),o("em",[e._v("quirk")]),e._v(" interessante. Isso porque ela contorna um grande problema com dispositivos PCI em alguns computadores, como em placas-mãe Z390 e praticamente todas as placas HEDT, como a X99 e a X299. O que ela faz é acessar as regiões de MMIO e remover os atributos de tempo de execução, permitindo que sejam usados como espaço onde o "),o("em",[e._v("kernel")]),e._v(" pode caber confortavelmente. Combinada com a "),o("em",[e._v("quirk")]),e._v(" "),o("code",[e._v("ProvideCustomSlide")]),e._v(", é possível manter o recurso de segurança do "),o("code",[e._v("slide")]),e._v(" ao mesmo tempo em que se torna possível iniciar o sistema.")]),e._v(" "),o("p",[e._v("Para computadores extremamente problemáticos, como o Threadripper TRX40 19H, é preciso encontrar as regiões específicas que não são necessárias para o funcionamento normal. É nesse momento em que o  "),o("code",[e._v("MmioWhitelist")]),e._v(" entra. Observe que o processo de "),o("em",[e._v("whitelisting")]),e._v(" não é necessário na maioria dos computadores.")]),e._v(" "),o("p",[e._v("Execute a versão de depuração do OpenCore com a opção DevirtualiseMmio e observe as seguintes informações no log:")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("21:495 00:009 OCABC: MMIO devirt start\n21:499 00:003 OCABC: MMIO devirt 0x60000000 (0x10000 pages, 0x8000000000000001) skip 0\n21:503 00:003 OCABC: MMIO devirt 0xFE000000 (0x11 pages, 0x8000000000000001) skip 0\n21:506 00:003 OCABC: MMIO devirt 0xFEC00000 (0x1 pages, 0x8000000000000001) skip 0\n21:510 00:003 OCABC: MMIO devirt 0xFED00000 (0x1 pages, 0x8000000000000001) skip 0\n21:513 00:003 OCABC: MMIO devirt 0xFEE00000 (0x1 pages, 0x800000000000100D) skip 0\n21:516 00:003 OCABC: MMIO devirt 0xFF000000 (0x1000 pages, 0x800000000000100D) skip 0\n21:520 00:003 OCABC: MMIO devirt end, saved 278608 KB\n")])])]),o("ul",[o("li",[e._v("Observação: Veja a página "),o("RouterLink",{attrs:{to:"/troubleshooting/debug.html"}},[e._v("Depurando o OpenCore")]),e._v(" para descobrir como ativar o arquivo de log.")],1)]),e._v(" "),o("p",[e._v("Neste exemplo, há 6 regiões que precisam ser verificadas para descobrir quais são ruins. A melhor estratégia é bloquear todas as seções de MMIO, "),o("em",[e._v("exceto")]),e._v(" uma, e tentar cada uma delas até obter uma lista das regiões boas.")]),e._v(" "),o("p",[e._v("Agora, o exemplo acima será utilizado para criar uma MmioWhitelist. Primeiramente, é preciso converter os endereços de hexadecimal para decimal:")]),e._v(" "),o("ul",[o("li",[e._v("MMIO devirt 0x60000000 -> 1610612736")]),e._v(" "),o("li",[e._v("MMIO devirt 0xFE000000 -> 4261412864")]),e._v(" "),o("li",[e._v("MMIO devirt 0xFEC00000 -> 4273995776")]),e._v(" "),o("li",[e._v("MMIO devirt 0xFED00000 -> 4275044352")]),e._v(" "),o("li",[e._v("MMIO devirt 0xFEE00000 -> 4276092928")]),e._v(" "),o("li",[e._v("MMIO devirt 0xFF000000 -> 4278190080")])]),e._v(" "),o("p",[e._v("Então, adicione cada um deles no caminho "),o("code",[e._v("Root > Booter > MmioWhitelist")]),e._v(", no arquivo "),o("code",[e._v("config.plist")]),e._v(". Crie uma entrada para cada linha e preencha as chaves da seguinte maneira:")]),e._v(" "),o("table",[o("thead",[o("tr",[o("th",{staticStyle:{"text-align":"left"}},[e._v("Chave")]),e._v(" "),o("th",{staticStyle:{"text-align":"left"}},[e._v("Tipo")]),e._v(" "),o("th",{staticStyle:{"text-align":"left"}},[e._v("Valor")])])]),e._v(" "),o("tbody",[o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Address")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("Number")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("1610612736")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Comment")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("String")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("Qualquer coisa que identifique os endereços, veja o exemplo na imagem abaixo.")])]),e._v(" "),o("tr",[o("td",{staticStyle:{"text-align":"left"}},[e._v("Enabled")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("Boolean")]),e._v(" "),o("td",{staticStyle:{"text-align":"left"}},[e._v("YES")])])])]),e._v(" "),o("p",[e._v("Deve ficar assim quando terminado:")]),e._v(" "),o("p",[o("img",{attrs:{src:t(486),alt:""}})])])}),[],!1,null,null,null);a.default=s.exports}}]);